# 第7章 用函数实现模块化程序设计

## 7.1 为什么要用函数
- 函数用来完成一定的功能
- 一个C程序由一个或多个程序模块组成，每一个程序模块作为一个源程序文件。一个源程序文件可以为多个C程序共用。
- 一个源程序文件由一个或多个函数以及其他有关内容（如指令、数据声明与定义等）组成。在程序编译时以源程序文件为单位进行编译。
- C程序的执行从main函数开始，在main函数中结束。
- 不能调用main函数，main函数是被操作系统调用的。
- 从用户使用角度，函数可分为库函数和自定义函数。
- 从函数形式上，函数分为无参函数和有参函数

## 7.2 怎样定义函数
C语言规定，在程序中用到的所有函数，必须“先定义，后使用”。即将函数名、函数返回值类型、函数实现的功能及参数个数与类型这些信息通知编译系统.

### 7.2.1 定义函数
一般形式：
类型名 函数名(形式参数表列)
{
    函数体
}
函数体包括声明部分和语句部分。

## 7.3 调用函数
函数调用的一般形式：函数名(实参表列)
在调用函数过程中发生的实参与形参之间的数据传递，称为“虚实结合”。形参是实参的一份临时拷贝。

### 7.3.3 函数调用过程
- 函数调用结束，形参单元被释放。注意：实参单元仍保留并维持原值，没有改变。
- 实参和形参在内存中占不同的内存单元，实参无法得到形参的值。

### 7.3.4 函数的返回值
如果函数值的类型和return语句中表达式的值不一致，则以函数类型为准。

## 7.4 函数声明和函数原型
- 自定义函数在调用它的函数后，应该在主调函数中对被调用做声明。声明的作用是把函数名、函数参数个数和参数类型等信息通知编译系统。
- 已定义的函数的首行，再加一个分号，就成了函数的声明。函数的首行称为函数原型。
- 编译系统只关心和检查参数个数和参数类型，而不检查参数名。

## 7.5 函数的嵌套调用
函数不能嵌套定义，但可以嵌套调用。

## 7.6 函数的递归调用
只应出现有限次数的、有终止的递归调用，可以用if语句来控制。

## 7.7 数组做函数参数
- 数组名作实参和形参，传递的是数组第一个元素的地址。
- 在用数组元素作函数实参时，把实参的值传给形参，是“值传递”方式。数据传递方向是从实参传到形参，单向传递.

### 7.7.2 数组名作函数参数
- 用数组元素作实参时，向形参变量传递的是数组元素的值。
- 用数组名作函数实参时，向形参（数组名或指针变量）传递的是数组首元素的地址。
- C语言编译系统并不检查形参数组大小，只是将实参数组的首元素地址传给形参数组名。
- 这样两个数组共占同一段内存单元，改变形参数组中数组元素的值，实参数组中的值也改变了。

### 7.7.3 多维数组名作函数参数
- 在定义二维数组时，必须指定列数，因为在内存中，数组时按行存放的。
- 在第二维大小相同的前提下，形参数组的第一位可以与实参数组不同。

## 7.8.1 局部变量
- 在一个函数内部或复合语句内部定义的变量。
- 主函数中定义的变量也只在主函数中有效。
- 不同函数可以使用同名的变量。
- 形参也是局部变量。
- 可以在复合语句内部定义变量。

## 7.8.2 全局变量
- 在函数之外定义的变量，可以为本文件中其他函数所共用。
- 建议不在必要时不使用全局变量：
  - 全局变量在程序的全部执行过程中都占用存储单元。
  - 全局变量是函数通用性降低。
- 全局变量第一个字母大写。

## 7.9.1 静态存储方式
- 程序运行期间有系统分配固定的存储空间的方式。
- 动态存储方式：程序运行期间根据需要进行动态的分配存储空间的方式。
- 内存供用户使用的存储空间可分为3部分：
  - 程序区
  - 静态存储区（存放全局变量）
  - 动态存储区（存放形参、自变量、返回地址）
- C的存储类别包括4部分：自动的（auto）、静态的（static）、寄存器的（register）、外部的（extern）。

## 7.9.3 全局变量的作用域
- 全局变量的作用域从定义出开始，到本程序文件的末尾。
- 用关键字extern对在定义点之前的外部变量作声明，表示把该外部变量的作用域扩展到此位置。
- 用extern声明外部变量时，类型名可写可省写。
- 编译时遇到extern，现在本文件中找外部变量的定义，如果找不到，就在连接时从其他文件中找外部变量的定义。
- 将外部变量的作用域限制在本文件，只需在每个文件中定义外部变量时加上static即可。
- 用static声明一个变量的作用是：
  - 对局部变量用static声明，把它分配到静态存储区，该变量在整个程序执行期间不释放，其所分配的空间始终存在。
  - 对全局变量用static声明，则该变量的作用域只限于本文件模块。

## 7.11.1 内部函数
- 函数只能被本文件中其他函数所调用。
- 一般形式：
static 类型名 函数名(形参表);
## 7.11.2 外部函数
- 函数可供其他文件调用。
- 一般形式：
extern 类型名 函数名(形参表);
- 如果定义函数是省略extern，则默认为外部函数。
- 函数原型的作用：把函数的作用与扩展到定义该函数的文件之外（不必使用extern）